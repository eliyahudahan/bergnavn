<!-- templates/blocks/waves_block.html -->
<!-- English-only comments: Waves block - prefer dedicated /maritime/api/waves, fallback to weather-pro -->
<div id="waves_block" class="card maritime-card shadow-sm">
  <div class="card-header bg-info text-white">
    <i class="bi bi-water"></i> Waves
  </div>
  <div class="card-body">
    <div id="waves_block_content" class="small">
      <div class="text-center">
        <div class="spinner-border text-info" role="status"></div>
        <div class="mt-2">Loading waves...</div>
      </div>
    </div>
  </div>
</div>

<script>
/* English-only comments:
   Try /maritime/api/waves, if not present fallback to /maritime/api/weather-pro wave data.
*/
(async function loadWavesBlock() {
  const container = document.getElementById('waves_block_content');

  // Try dedicated waves endpoint first
  let res = await fetchSafeJson('/maritime/api/waves');
  if (res.ok && res.data && typeof res.data.wave_height !== 'undefined') {
    const w = res.data;
    container.innerHTML = `<div>Wave height: ${w.wave_height} m<br>Period: ${w.period || '—'} s</div>`;
    return;
  }

  // Fallback: use weather-pro
  res = await fetchSafeJson('/maritime/api/weather-pro');
  if (res.ok && res.data) {
    const w = res.data;
    const waves = w.wave_height ?? w.significant_wave_height ?? '—';
    container.innerHTML = `<div>Wave height: ${waves} m (from weather)</div>`;
    return;
  }

  container.innerHTML = `<div class="text-warning">Wave data unavailable</div>`;
})();
</script>
