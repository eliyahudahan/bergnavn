<!-- backend/templates/maritime_dashboard.html - Maritime Dashboard Template -->
<!-- Enhanced with real-time data integration and improved UI components -->

{% extends "base.html" %}

{% block title %}{{ translate('title', lang, 'maritime_page') }}{% endblock %}

{% block head %}
<!-- Additional head content for maritime dashboard -->
<style>
    .weather-card {
        transition: transform 0.2s ease-in-out;
    }
    .weather-card:hover {
        transform: translateY(-2px);
    }
    .maritime-map {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 8px;
        overflow: hidden;
    }
    .status-badge {
        font-size: 0.8rem;
        padding: 0.5rem 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
    <!-- Header Section with Official Data -->
    <!-- Displays real-time maritime operations data and system status -->
    <div class="text-center mb-5">
        <h1 class="display-4 mb-3">üö¢ {{ translate('title', lang, 'maritime_page') }}</h1>
        <p class="lead text-muted">{{ translate('maritime_description', lang, 'global') }}</p>
        
        <!-- Status Bar - Shows real-time API connection status -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-center align-items-center gap-3 flex-wrap">
                    <span id="api-status" class="badge status-badge bg-success">
                        <i class="bi bi-cloud-check"></i> Connecting...
                    </span>
                    <button id="refresh-weather" class="btn btn-sm btn-outline-primary">
                        <i class="bi bi-arrow-clockwise"></i> Refresh Weather
                    </button>
                    <small class="text-muted" id="last-update">
                        Last update: <span id="update-time">Just now</span>
                    </small>
                </div>
            </div>
        </div>
        
        <!-- Statistics Bar with Official SSB Data -->
        <!-- Real-time metrics showing cargo volume, ETA, and fuel optimization -->
        <div class="row mt-4">
            <div class="col-md-4 mb-3">
                <div class="card text-white bg-primary h-100">
                    <div class="card-body text-center">
                        <div class="display-6 mb-2">üì¶</div>
                        <h5>{{ translate('cargo_volume', lang, 'global') }}</h5>
                        <h3>975,870 tons</h3>
                        <small class="opacity-75">Q2 2025 ({{ translate('official_data', lang, 'maritime_page') }})</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card text-white bg-success h-100">
                    <div class="card-body text-center">
                        <div class="display-6 mb-2">‚è±Ô∏è</div>
                        <h5>{{ translate('route_eta', lang, 'global') }}</h5>
                        <h3>18-22 hours</h3>
                        <small class="opacity-75" id="route-eta-display">
                            Kristiansand ‚Üî Oslo<br>
                            <span class="eta-details">Calculating enhanced ETA...</span>
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card text-white bg-warning h-100">
                    <div class="card-body text-center">
                        <div class="display-6 mb-2">üí∞</div>
                        <h5>{{ translate('fuel_optimization', lang, 'global') }}</h5>
                        <h3 id="fuel-saving-value">15%+</h3>
                        <small class="opacity-75" id="fuel-saving-details">
                            {{ translate('fuel_savings', lang, 'maritime_page') }}<br>
                            <span>Based on current fleet data</span>
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Weather Alert Section with MET Norway Data -->
    <!-- Real-time weather data from MET Norway API -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-warning shadow-sm">
                <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="bi bi-cloud-sun"></i> {{ translate('weather_forecasts', lang, 'maritime_page') }}
                    </h5>
                    <small class="text-muted">Live MET Norway Data</small>
                </div>
                <div class="card-body">
                    <div class="row g-3" id="weather-data">
                        <!-- Weather data will be loaded here dynamically by JavaScript -->
                        <!-- Loading state shown during initial data fetch -->
                        <div class="col-12 text-center py-4">
                            <div class="spinner-border text-primary mb-3" role="status">
                                <span class="visually-hidden">Loading maritime weather data...</span>
                            </div>
                            <p class="mb-1">Loading real-time weather data from MET Norway...</p>
                            <small class="text-muted">Connecting to official Norwegian meteorological service</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Map Container -->
    <!-- Interactive maritime route visualization -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
                <i class="bi bi-geo-alt"></i> {{ translate('live_map', lang, 'maritime_page') }}
            </h5>
            <span class="badge bg-info" id="vessel-count">
                <i class="bi bi-ship"></i> <span id="ship-count">12</span> vessels
            </span>
        </div>
        <div class="card-body p-0">
            <div id="maritime-map" class="maritime-map" style="height: 500px;">
                <!-- Map content will be loaded dynamically by JavaScript -->
                <!-- Fallback content shown during initialization -->
                <div class="h-100 d-flex align-items-center justify-content-center text-white">
                    <div class="text-center p-4">
                        <div class="display-1 mb-3">üó∫Ô∏è</div>
                        <h4>{{ translate('route_visualization', lang, 'maritime_page') }}</h4>
                        <p class="mb-3">{{ translate('coming_soon', lang, 'maritime_page') }}</p>
                        <div class="bg-light text-dark rounded p-3 d-inline-block">
                            <small>
                                <strong>Kristiansand ‚Üî Oslo Route</strong><br>
                                <span class="text-muted">Real-time vessel tracking active</span>
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions Section -->
    <!-- Data science and optimization features -->
    <div class="row mb-4">
        <div class="col-md-6 mb-3">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-6 text-primary mb-3">üìä</div>
                    <h5>{{ translate('route_analytics', lang, 'maritime_page') }}</h5>
                    <p class="text-muted mb-3">Analyze historical and real-time route data with advanced analytics</p>
                    <button class="btn btn-outline-primary" onclick="showComingSoon('Route Analytics')">
                        <i class="bi bi-graph-up"></i> {{ translate('coming_soon', lang, 'maritime_page') }}
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-3">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-6 text-success mb-3">‚ö°</div>
                    <h5>{{ translate('fuel_optimization', lang, 'global') }}</h5>
                    <p class="text-muted mb-3">Calculate optimal speed and fuel consumption with AI recommendations</p>
                    <button class="btn btn-outline-success" onclick="showComingSoon('Fuel Optimization')">
                        <i class="bi bi-lightning-charge"></i> {{ translate('coming_soon', lang, 'maritime_page') }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Sources Information -->
    <!-- Official data sources and API integrations -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header">
            <h6 class="mb-0">
                <i class="bi bi-database"></i> {{ translate('data_sources', lang, 'maritime_page') }}
            </h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                            <strong>SSB Norway</strong> - {{ translate('official_statistics', lang, 'maritime_page') }}
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                            <strong>Kystverket</strong> - AIS live data and vessel tracking
                        </li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                            <strong>MET Norway</strong> - {{ translate('weather_forecasts', lang, 'maritime_page') }}
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                            <strong>RouteInfo.no</strong> - {{ translate('maritime_routes', lang, 'maritime_page') }}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Technical Implementation Note -->
    <!-- Shows the advanced technical capabilities of the platform -->
    <div class="card border-0 bg-light">
        <div class="card-body text-center py-3">
            <small class="text-muted">
                <strong>Technical Implementation:</strong> 
                Integrated with official Norwegian data APIs ‚Ä¢ 
                Real-time MET Norway weather integration ‚Ä¢ 
                Advanced Data Science analytics ‚Ä¢ 
                Modern web technology stack
            </small>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- Maritime Dashboard JavaScript -->
<!-- Main JavaScript file handling all real-time data and interactions -->
<script src="{{ url_for('static', filename='js/maritime.js') }}"></script>

<!-- Additional JavaScript for enhanced functionality -->
<script>
    /**
     * Show coming soon notification for features in development
     * @param {string} featureName - Name of the feature
     */
    function showComingSoon(featureName) {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = 'alert alert-info alert-dismissible fade show';
        notification.style.position = 'fixed';
        notification.style.top = '20px';
        notification.style.right = '20px';
        notification.style.zIndex = '9999';
        notification.style.minWidth = '300px';
        notification.innerHTML = `
            <strong>${featureName}</strong> is coming soon!<br>
            <small>This feature is currently in development.</small>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(notification);
        
        // Auto-remove after 5 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 5000);
    }

    /**
     * Update the last update timestamp
     */
    function updateTimestamp() {
        const now = new Date();
        const timeString = now.toLocaleTimeString();
        const updateElement = document.getElementById('update-time');
        if (updateElement) {
            updateElement.textContent = timeString;
        }
    }

    // Update timestamp every minute
    setInterval(updateTimestamp, 60000);
    
    // Initial timestamp update
    document.addEventListener('DOMContentLoaded', updateTimestamp);
</script>
{% endblock %}